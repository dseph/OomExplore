Lots of example code in https://msdn.microsoft.com/EN-US/library/office/ff184631.aspx
